## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/doc/CodeOrganization.md

**Start chunk id:** 08abf71d046589d62bb8cd2565098c07afb1f95b6b97ab0c13ac96bcba21047a

## Content

**Question:** What is the typical structure of a submodule in the AliceO2 repository?

**Answer:** A typical submodule in the AliceO2 repository is structured as follows:

```
.
|-- Common
|   |-- CMakeLists.txt
|   |-- doc
|   |   `-- All documentation files
|   |-- include
|   |   `-- Common
|   |       `-- Factory.h
|   |-- src
|   |   |-- Internal.h
|   |   `-- Factory.cxx
|   `-- test
|       `-- TestFactory.cxx
```

Headers are placed in the `include` directory if they are part of the interface, otherwise, they go in the `src` directory. Some subdirectories may be left out or added as necessary.

---

**Question:** What specific actions should be taken regarding subdirectories in a typical submodule, and what is the purpose of separating headers into the include and src directories?

**Answer:** For a typical submodule, some subdirectories can be voluntarily left out or added depending on the specific needs. Headers should be placed in the include directory if they form part of the interface, and in the src directory if they do not. This separation helps in maintaining a clear distinction between public and private code, enhancing modularity and ease of use for developers.

---

**Question:** What specific actions should be taken if a new subdirectory needs to be added to a typical submodule, and how does this affect the placement of headers and source files?

**Answer:** If a new subdirectory needs to be added to a typical submodule, one should consider the specific needs and content of this subdirectory. If the content involves headers that are part of the interface, these should be placed in the include directory. Conversely, if the content consists of source files, they should be placed in the src directory. The decision on whether to include the new subdirectory depends on the organization's needs and the nature of the files it contains, ensuring that the interface and implementation are clearly separated.

---

**Question:** What does AliceO2 contain according to the document?

**Answer:** AliceO2 contains:
- Detector specific code such as reconstruction, simulation, calibration, and quality control.
- Commonalities including DataFormat and Steer-like components that other parts depend on but haven't been moved to separate repositories.
- Global algorithms that rely on multiple detectors.
The repository structure is a blend of per-detector and per-function sub-modules, each following a camel-case naming convention where repeated or structural elements begin with a lowercase letter.

---

**Question:** What is the rationale behind AliceO2's decision to have a mixture of per-detector and per-function sub-modules in its directory structure?

**Answer:** AliceO2 adopted a mixture of per-detector and per-function sub-modules in its directory structure to achieve a balance between organization by detector-specific functionalities and organization by general functionality. This approach allows for maintaining a clear separation of concerns for each detector while also centralizing common algorithms and utilities that are used across multiple detectors. The per-detector organization helps in managing specific aspects related to individual detectors such as reconstruction, simulation, calibration, and quality control. Meanwhile, the per-function organization enables the sharing of global algorithms and common tools that are not specific to any single detector but are essential for the entire AliceO2 framework. This hybrid structure leverages the strengths of both approaches, promoting modularity and reusability without overwhelming the project with too many repositories.

---

**Question:** What is the rationale behind AliceO2 favoring the extraction of large common components into separate repositories, and how does this affect the structure and dependency management within the AliceO2 main repository?

**Answer:** AliceO2 opts for the extraction of large common components into separate repositories to enhance modularity and maintainability. By isolating shared functionalities in dedicated repositories, AliceO2 ensures that these components can be easily updated and reused across different projects without cluttering the main repository. This approach simplifies dependency management within the AliceO2 main repository, as it can focus on detector-specific and global algorithms rather than managing numerous shared functionalities internally.

The structure within the AliceO2 main repository reflects this strategy by incorporating a mixture of per-detector and per-function sub-modules. Detector-specific code is grouped under relevant detectors, while common functionalities are organized into per-function sub-modules. This hybrid structure facilitates clear identification and access to both detector-specific and shared components, aiding in efficient development and maintenance.

By adopting a modular approach, AliceO2 minimizes redundancy and promotes code reusability. Dependencies on these external repositories are clearly defined, making the main repository leaner and more focused on its core responsibilities. This results in a more organized and manageable codebase, which is easier to navigate and extend.

---

**Question:** What type of names are used for repeated or structural elements in the document, and what is an example of such a name?

**Answer:** Repeated or structural names in the document are used with a lower case letter at the start. An example of such a name is "src".

---

**Question:** Why are headers for a module named "MyModule" stored in the directory "MyModule/include/MyModule" instead of "MyModule/include"?

**Answer:** Headers for a module named "MyModule" are stored in the directory "MyModule/include/MyModule" instead of "MyModule/include" to adhere to the constraints of header installation and usage. Specifically, headers must be installed in a directory named after the module, and code using these headers must include `MyModule/xyz.h`, working both when the headers are installed and when they are internal. This placement ensures compatibility whether the headers are part of the AliceO2 installation or in a separate repository.

---

**Question:** What are the specific constraints that necessitated placing headers in `MyModule/include/MyModule` rather than directly in `MyModule/include`, and why is this solution considered not-perfect?

**Answer:** The specific constraints that necessitated placing headers in `MyModule/include/MyModule` rather than directly in `MyModule/include` are:

1. Headers must be installed in a directory named after the module.
2. Code using the headers must include `MyModule/xyz.h`, and this must work whether the headers are installed or internal.

This solution is considered not-perfect because it is not the ideal approach and does not fully meet all constraints. It required a compromise due to the complexity of other potential solutions, which either broke a constraint or necessitated significant CMake configuration.