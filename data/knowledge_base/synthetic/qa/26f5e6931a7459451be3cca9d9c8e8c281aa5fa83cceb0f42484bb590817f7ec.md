## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/DATA/production/calib/phs-pedestal.sh

**Start chunk id:** 26f5e6931a7459451be3cca9d9c8e8c281aa5fa83cceb0f42484bb590817f7ec

## Content

**Question:** What workflow components are used for pedestal calibration and how are they configured in the given document?

**Answer:** The workflow components used for pedestal calibration include:

1. o2-phos-reco-workflow - Configured with options to enable pedestal calibration using the command `--pedestal on`.

2. o2-phos-calib-workflow - Specifically tasked with pedestal calibration and statistics generation through the flags `--pedestals` and `--statistics ${max_statistics}`, with an option to force an update.

These components are integrated into the workflow by the lines:

```
add_W o2-phos-reco-workflow "--input-type raw --output-type cells --pedestal on --disable-root-input --disable-root-output --condition-backend ${pull_ccdb_path}" 
add_W o2-phos-calib-workflow "--pedestals --statistics ${max_statistics} --forceupdate"
```

Additionally, if the QC configuration is specified, the corresponding QC component is added to the workflow using:

```
workflow_has_parameter QC && add_QC_from_consul "${QC_CONFIG}"
```

However, the specific configuration for the QC component (`QC_CONFIG`) is not detailed within the provided document.

---

**Question:** What is the default value of the `max_statistics` variable and how does it get updated if the `PHS_MAX_STATISTICS` environment variable is set?

**Answer:** The default value of the `max_statistics` variable is 5000. If the `PHS_MAX_STATISTICS` environment variable is set, its value overrides the default, setting `max_statistics` to the value of `PHS_MAX_STATISTICS`.

---

**Question:** What are the key configurations and parameters used in the o2-phos-calib-workflow for pedestal calibration and statistics?

**Answer:** The key configurations and parameters used in the o2-phos-calib-workflow for pedestal calibration and statistics include:

- Pedestal calibration is enabled with the flag `--pedestal on`.
- Statistics are configured with the parameter `--statistics`, which is set to `$PHS_MAX_STATISTICS`.
- The calibration workflow is linked to a CCDB server for accessing necessary calibration data through the configuration key value `NameConf.mCCDBServer=${PHS_CCDB_PATH}`.
- The workflow forces an update with `--forceupdate`, ensuring that the calibration data is updated even if no changes are detected.

---

**Question:** What is the purpose of the `sed` command in the script and how does it affect the output when `WORKFLOWMODE` is set to "print"?

**Answer:** The `sed` command is used to format the `WORKFLOW` string so that it is printed line by line when `WORKFLOWMODE` is set to "print". Specifically, it replaces multiple occurrences of spaces (denoted as `| *`) with a newline character (`\n`), effectively splitting the workflow command into separate lines. This makes the printed workflow command more readable and easier to understand.