## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/doc/Upgrades.md

**Start chunk id:** 151588c2186ab8b2231b0885f486a8ffbddba4c78b9badfae8d44a49f2df92be

## Content

**Question:** What specific steps are required to ensure that code for detector upgrades is compiled only when the `ENABLE_UPGRADES` option is activated in CMake?

**Answer:** To ensure that code for detector upgrades is compiled only when the `ENABLE_UPGRADES` option is activated in CMake, the following steps should be taken:

1. Place the upgrade code in the `Detectors/Upgrades` and `DataFormats/Detectors/Upgrades` directories.
2. Protect CMake instructions specific to upgrades by enclosing them within an `if(ENABLE_UPGRADES)` block.
3. For individual pieces of code that need to be compiled only when upgrades are being built, guard these with the `#ifdef ENABLE_UPGRADES` and `#endif` directives.

These measures ensure that the upgrade code is conditionally compiled based on the `ENABLE_UPGRADES` option in the CMake configuration.