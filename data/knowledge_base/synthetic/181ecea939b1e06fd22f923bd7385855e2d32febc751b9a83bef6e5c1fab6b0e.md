## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/GRID/utils/fetch_output_onfailure.sh

**Start chunk id:** 181ecea939b1e06fd22f923bd7385855e2d32febc751b9a83bef6e5c1fab6b0e

## Content

**Question:** What is the purpose of the `RecycleBase` variable and how is it determined in the script?

**Answer:** The `RecycleBase` variable is used to store the base path of the recycle directory where the failed job outputs are stored, without the job-specific identifier. It is determined by parsing the output of `alien.py ps --trace ${jobid}` for the line containing "Going to uploadOutputFiles". From this line, the script extracts the output directory using `awk` and `sed` commands. Then, it removes the job ID part using parameter expansion to isolate the base path, which is stored in `RecycleBase`.

---

**Question:** What commands are used to filter and extract subjob IDs that failed from the master job logs?

**Answer:** The commands used to filter and extract subjob IDs that failed from the master job logs are:

1. `alien.py ps -a -m ${MY_JOBID} -f ERROR_ALL` - This command lists all subjobs of the specified master job and filters for those that have an error status.

2. `awk '/EE/{print $2}'` - This `awk` command filters the output to only include lines containing "EE", which typically denotes errors, and then prints the second field, which is the subjob ID.

3. `tr '\n' ' '` - This command replaces newline characters with spaces, effectively concatenating the subjob IDs into a single string separated by spaces.

---

**Question:** What command is used to extract log files from the archive files in the specified directory?

**Answer:** The command used to extract log files from the archive files in the specified directory is:

unzip -q -o ${OutputDir}/${jobid}/log_archive.zip -d ${OutputDir}/${jobid}