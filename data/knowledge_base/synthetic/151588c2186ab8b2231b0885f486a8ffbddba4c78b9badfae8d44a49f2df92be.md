## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/doc/Upgrades.md

**Start chunk id:** 151588c2186ab8b2231b0885f486a8ffbddba4c78b9badfae8d44a49f2df92be

## Content

**Question:** What is the CMake option used to activate the compilation of detector upgrades in the O2 simulation?

**Answer:** The CMake option used to activate the compilation of detector upgrades in the O2 simulation is `ENABLE_UPGRADES`.

---

**Question:** What specific steps are required to ensure that code for detector upgrades is compiled only when the `ENABLE_UPGRADES` option is activated in CMake?

**Answer:** To ensure that code for detector upgrades is compiled only when the `ENABLE_UPGRADES` option is activated in CMake, the following steps should be taken:

1. Place the upgrade code in the `Detectors/Upgrades` and `DataFormats/Detectors/Upgrades` directories.
2. Protect CMake instructions specific to upgrades by enclosing them within an `if(ENABLE_UPGRADES)` block.
3. For individual pieces of code that need to be compiled only when upgrades are being built, guard these with the `#ifdef ENABLE_UPGRADES` and `#endif` directives.

These measures ensure that the upgrade code is conditionally compiled based on the `ENABLE_UPGRADES` option in the CMake configuration.

---

**Question:** How would you guard a specific piece of code in C++ so that it is only compiled when the `ENABLE_UPGRADES` option is enabled in the O2 simulation documentation?

**Answer:** To guard a specific piece of code in C++ so that it is only compiled when the `ENABLE_UPGRADES` option is enabled, you should use the precompiler macro `ENABLE_UPGRADES` as follows:

```c++
#ifdef ENABLE_UPGRADES
// Code to be compiled only when ENABLE_UPGRADES is enabled
#endif
```