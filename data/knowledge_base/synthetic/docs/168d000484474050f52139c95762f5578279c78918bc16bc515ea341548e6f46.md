## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/MC/run/examples/event_pool.sh

**Start chunk id:** 168d000484474050f52139c95762f5578279c78918bc16bc515ea341548e6f46

## Content

if $MAKE; then
    echo "Started generation of event pool"
    # Workflow creation. The parameters used are for illustration purposes only
    # The workflow will generate events but will not proceed to transport. It will halt after event generation and will finalize by merging all kinematic root files from the specified timeframes into a file named evtpool.root in the current directory
    ${O2DPG_ROOT}/MC/bin/o2dpg_sim_workflow.py -eCM 14000 -col pp -gen pythia8 -proc cdiff -tf 2 -ns 5000 --make-evtpool -seed 546 -interactionRate 500000 -productionTag "evtpoolcreation" -o evtpool
    # Workflow runner
    ${O2DPG_ROOT}/MC/bin/o2dpg_workflow_runner.py -f evtpool.json -tt pool
elif [[ -n "$INPUT" ]]; then
    echo "Input file provided: $INPUT"
    if [[ -f "$INPUT" && -s "$INPUT" ]] || [[ "$INPUT" == alien://* ]]; then
        # Workflow creation. Phi Rotation is manually set, whereas the event randomization is handled by default

---

DOCUMENT:
    ${O2DPG_ROOT}/MC/bin/o2dpg_sim_workflow.py -eCM 14000 -confKey "GeneratorFromO2Kine.randomphi=true;GeneratorFromO2Kine.fileName=$INPUT" -gen extkinO2 -tf 2 -ns 10 -e TGeant4 -j 4 -interactionRate 500000 -seed 546 -productionTag "evtpooltest"
        # Workflow runner with rerun option to avoid manual file deletion if the script is executed in the same folder
        ${O2DPG_ROOT}/MC/bin/o2dpg_workflow_runner.py -f workflow.json -tt aod --rerun-from grpcreate
    else
        echo "Error: The file does not exist or is empty: $INPUT"
        exit 1
    fi
else
    echo "Usage: $0 [--make] [-i|--input <input_file>]"
    exit 1
fi

---

#!/usr/bin/env bash

# Example of how to generate an event pool and integrate it into the O2DPG simulation pipeline.

# Ensure that O2DPG and O2 are properly loaded.
[ ! "${O2DPG_ROOT}" ] && echo "Error: O2DPG needs to be loaded" && exit 1
[ ! "${O2_ROOT}" ] && echo "Error: O2 needs to be loaded" && exit 1

# Argument parsing
MAKE=false
INPUT=""

help() {
    echo "Usage: $0 [--make] [-i|--input <input_file>]"
    echo "  --make: Generate the event pool"
    echo "  -i|--input: Path to the input event pool file to be utilized in the simulation. Supports Alien paths."
    echo "              The full path must be specified (use of environment variables is allowed), otherwise the process will fail."
    echo "  -h|--help: Display this help message"
    exit 0
}

while [[ "$#" -gt 0 ]]; do
    case $1 in
        --make) MAKE=true ;;
        -i|--input) INPUT="$2"; shift ;;
        -h|--help) help ;;
        *) echo "Unknown operation: $1"; help ;;
    esac
    shift
done