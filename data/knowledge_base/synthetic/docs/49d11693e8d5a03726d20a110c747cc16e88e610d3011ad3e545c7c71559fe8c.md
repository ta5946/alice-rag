## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/DATA/testing/detectors/TRD/trd-noise.sh

**Start chunk id:** 49d11693e8d5a03726d20a110c747cc16e88e610d3011ad3e545c7c71559fe8c

## Content

# Begin with an empty workflow
WORKFLOW=
add_W o2-dpl-raw-proxy "--dataspec \"$PROXY_INSPEC\" --inject-missing-data --readout-proxy \"--channel-config \\\"name=readout-proxy,type=pull,method=connect,address=ipc://@tf-builder-pipe-0,transport=shmem,rateLogging=1\\\"\"" "" 0
add_W o2-trd-datareader "--disable-root-output --every-nth-tf $TRD_REJECTION_FACTOR --pipeline trd-datareader:$TRD_N_READERS"
add_W o2-calibration-trd-workflow "--perform-noise-correction --calibration-dds-collection-index 0"
add_W o2-calibration-ccdb-populator-workflow "--ccdb-path $TRD_CCDB_PATH"

---

# Add the o2-dpl-run workflow manually, with the option to print the workflow or create a topology (default)
WORKFLOW+="o2-dpl-run $GLOBALDPLOPT $ARGS_ALL"
[[ $WORKFLOWMODE != "print" ]] && WORKFLOW+=" --${WORKFLOWMODE} ${WORKFLOWMODE_FILE:-}"
[[ $WORKFLOWMODE == "print" || "${PRINT_WORKFLOW:-}" == "1" ]] && echo "#Workflow command:\n\n${WORKFLOW}\n" | sed -e "s/\\\\n/\n/g" -e"s/| */| \\\\\n/g" | eval cat $( [[ $WORKFLOWMODE == "dds" ]] && echo '1>&2')
if [[ $WORKFLOWMODE != "print" ]]; then eval $WORKFLOW; else true; fi

---

#!/usr/bin/env bash

# Load common arguments and helper functions like add_W
source common/setenv.sh
source common/getCommonArgs.sh
source common/gen_topo_helper_functions.sh


# Specify input data needed by DPL (here, all RAWDATA from TRD)
PROXY_INSPEC="A:TRD/RAWDATA;dd:FLP/DISTSUBTIMEFRAME/0;eos:***/INFORMATION"

# Permit setting external options
if [ -z $TRD_CCDB_PATH ]; then
  TRD_CCDB_PATH="http://o2-ccdb.internal"
fi
if [ -z $TRD_REJECTION_FACTOR ]; then
  TRD_REJECTION_FACTOR=4
fi
if [ -z $TRD_N_READERS ]; then
  TRD_N_READERS=16
fi