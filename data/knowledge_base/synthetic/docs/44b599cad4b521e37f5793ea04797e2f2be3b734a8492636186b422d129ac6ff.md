## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/DATA/production/getCommonArgs.sh

**Start chunk id:** 44b599cad4b521e37f5793ea04797e2f2be3b734a8492636186b422d129ac6ff

## Content

DOCUMENT:
    ARGS_ALL="--session ${OVERRIDE_SESSION:-default} --severity $SEVERITY --shm-segment-id ${O2JOBSHMID:-$NUMAID} --shm-segment-size $SHMSIZE ${ARGS_ALL_EXTRA:-} --early-forward-policy noraw"
ARGS_ALL_CONFIG="keyval.input_dir=$FILEWORKDIR;keyval.output_dir=/dev/null;${ALL_EXTRA_CONFIG:-}"
if [[ $EPNSYNCMODE == 1 ]]; then
  ARGS_ALL+=" --infologger-severity $INFOLOGGER_SEVERITY"
  ARGS_ALL+=" --monitoring-backend influxdb-unix:///tmp/telegraf.sock --resources-monitoring ${GEN_TOPO_RESOURCE_MONITORING:-15} ${GEN_TOPO_RESOURCE_MONITORING:+--dpl-stats-min-online-publishing-interval $GEN_TOPO_RESOURCE_MONITORING}"
  ARGS_ALL_CONFIG+="NameConf.mCCDBServer=$GEN_TOPO_EPN_CCDB_SERVER;"
  export DPL_CONDITION_BACKEND=$GEN_TOPO_EPN_CCDB_SERVER
  [[ -z ${O2_DPL_DEPLOYMENT_MODE:-} ]] && O2_DPL_DEPLOYMENT_MODE=OnlineECS
elif [[ "${ENABLE_METRICS:-}" != "1" ]]; then
  ARGS_ALL+=" --monitoring-backend no-op://"
fi

---

#!/bin/bash

# to prevent sourcing this file multiple times
if [[ -z ${SOURCE_GUARD_GETCOMMONARGS:-} ]]; then
SOURCE_GUARD_GETCOMMONARGS=1

if [[ -z $SEVERITY || -z $NUMAID || -z $SHMSIZE || -z $FILEWORKDIR || -z $EPNSYNCMODE || -z $INFOLOGGER_SEVERITY || -z $SHMTHROW || -z $NORATELOG ]]; then
  echo "Missing Configuration Environment Variables in getCommonArgs.sh" 1>&2
  exit 1
fi

---

[[ ! -z ${O2_DPL_EXIT_TRANSITION_TIMEOUT_DEFAULT:-} ]] && ARGS_ALL+=" --exit-transition-timeout $O2_DPL_EXIT_TRANSITION_TIMEOUT_DEFAULT"
[[ ! -z ${O2_DPL_PROCESSING_TRANSITION_TIMEOUT_DEFAULT:-} ]] && ARGS_ALL+=" --data-processing-timeout $O2_DPL_PROCESSING_TRANSITION_TIMEOUT_DEFAULT"

true

fi # getCommonArgs.sh sourced

---

elif [[ "${ENABLE_METRICS:-}" != "1" ]]; then
  ARGS_ALL+=" --monitoring-backend no-op://"
fi
[[ $SHMTHROW == 0 ]] && ARGS_ALL+=" --bad-alloc-max-attempts 60 --bad-alloc-attempt-interval 1000"
[[ ! -z ${SHM_MANAGER_SHMID:-} && ${GEN_TOPO_CALIB_WORKFLOW:-} != 1 ]] && ARGS_ALL+=" --no-cleanup --shm-no-cleanup on --shmid $SHM_MANAGER_SHMID"
[[ $NORATELOG == 1 ]] && ARGS_ALL+=" --fairmq-rate-logging 0"