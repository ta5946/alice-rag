## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/MC/run/PWGHF/calc_embedding_speedup.sh

**Start chunk id:** fb54569fa40a6d18fc79905d9a126ab47cd76d9ebd69e8fb712467677739f907

## Content

#!/bin/bash

# Determine embedding gain
# Currently, reconstruction is not factored in
# (presumes previous execution of embedding_benchmark.sh)
BKGSIMTIME=$(awk '//{print $2}' ${PWD}/bkgsim.log_time)
SGNTIME=$(awk 'BEGIN{c=0} //{c+=$2} END {print c}' sgnsim*.log_time)
DIGITIME=$(awk 'BEGIN{c=0} //{c+=$2} END {print c}' *digi*.log_time)

# GAIN = (NTIMEFRAMES * BKGSIMTIME + SGNTIME + DIGITIME) / (BKGSIMTIME + SGNTIME + DIGITIME)
awk -v BT=${BKGSIMTIME} -v ST=${SGNTIME} -v DT=${DIGITIME} -v NTF=${NTIMEFRAMES} 'END {print "SPEEDUP="(NTF*BT + ST + DT)/(BT + ST + DT)}' < /dev/null