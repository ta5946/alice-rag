## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/MC/run/PWGHF/analysis_benchmark.sh

**Start chunk id:** 472836637d19a35d287d6ce71ee5620209cc9fc77b48bda1ac932b2ad5e5b723

## Content

${O2DPG_ROOT}/MC/bin/o2dpg-workflow-tools.py combine workflow workflow_ana -o workflow_combined


# execute workflow
${O2DPG_ROOT}/MC/bin/o2_dpg_workflow_runner.py -f workflow_combined.json

---

# create simulation workflow
${O2DPG_ROOT}/MC/bin/o2dpg_sim_workflow.py -eCM 5020 -col pp -gen pythia8 -proc ${PYPROCESS} -tf ${NTIMEFRAMES} -nb ${NBKGEVENTS} \
                                                        -ns ${NSIGEVENTS} -e ${SIMENGINE} -interactionRate 500000   \
                                                        -j ${NWORKERS} -genBkg pythia8 --embedding

# Simulating a user extending this workflow with an analysis task
${O2DPG_ROOT}/MC/bin/o2dpg-workflow-tools.py create workflow_ana --add-task mchist
needs="aodmerge"

# Notes:
#   1. The output AOD name is determined by the simulation workflow
#   2. The base name of the AOD merge task is aodmerge
${O2DPG_ROOT}/MC/bin/o2dpg-workflow-tools.py modify workflow_ana mchist --cmd "o2-analysistutorial-mc-histograms --aod-file AO2D.root" \
                                                                        --needs $needs --mem 2000 --cpu 1 --labels ANALYSIS

---

#!/bin/bash

#
# An example workflow for MC->RECO->AOD processing aimed at studying embedding speedups.
# Background events are reused across different timeframes.
#

# Ensure O2DPG and O2 are loaded
if [ -z "${O2DPG_ROOT}" ]; then echo "Error: This requires O2DPG to be loaded"; exit 1; fi
if [ -z "${O2_ROOT}" ]; then echo "Error: This requires O2 to be loaded"; exit 1; fi


# ----------- START ACTUAL JOB  ----------------------------- 

NSIGEVENTS=${NSIGEVENTS:-20}
NTIMEFRAMES=${NTIMEFRAMES:-5}
NWORKERS=${NWORKERS:-8}
NBKGEVENTS=${NBKGEVENTS:-20}
MODULES="--skipModules ZDC"
SIMENGINE=${SIMENGINE:-TGeant4}
PYPROCESS=${PYPROCESS:-ccbar} #ccbar, bbar, ...