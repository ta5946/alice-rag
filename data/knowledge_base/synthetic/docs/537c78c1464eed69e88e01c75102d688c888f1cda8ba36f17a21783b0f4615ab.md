## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/run/SimExamples/HepMC_EPOS4/epos.sh

**Start chunk id:** 537c78c1464eed69e88e01c75102d688c888f1cda8ba36f17a21783b0f4615ab

## Content

#!/bin/bash
# Script based on CRMC example
# For EPOS4 option files, ensure ihepmc is set to 2 to output HepMC data to stdout. The -hepstd flag is essential to avoid printing unnecessary information (a z-*optns*.mtr file will be generated).

optns="example"
seed=1
EPOS4=""

if [ -z "$EPO4VSN" ]; then
    # Error: EPO4VSN environment variable is not set
    exit 1
fi

if [ "$EPO4VSN" = "4.0.0" ]; then
    EPOS4="$EPOS4_ROOT/epos4/scripts/epos"
else
    EPOS4="$EPOS4_ROOT/bin/epos"
fi

while test $# -gt 0 ; do
    case $1 in
        -i|--input)   optns=$2 ; shift ;;
        -s|--seed)    seed=$2 ; shift ;;
        -h|--help) usage; exit 0 ;;
    esac
    shift
done

if [ ! -f $optns.optns ]; then
    echo "Error: Options file $optns.optns not found"
    exit 2
fi

---

if [ ! -f $optns.optns ]; then
    echo "Error: The options file $optns.optns was not found"
    exit 2
fi

if grep -Fq "set ihq 1" $optns.optns; then
    if [ -z "$EPO4HQVSN" ]; then
        # Error: The EPOS4HQ version could not be found
        exit 3
    else
        # Running with EPOS4HQ
        EPOS4="$EPO4HQ/bin/eposhq"
    fi
fi

if [ $seed -eq 0 ]; then
    # Seed cannot be 0, a random number will be used instead
    seed="$RANDOM"
fi

# The OR filter processes the stdout, extracting only the useful HepMC data
$EPOS4 -hepstd -s $seed $optns | sed -n 's/^\(HepMC::\|[EAUWVP] \)/\1/p'