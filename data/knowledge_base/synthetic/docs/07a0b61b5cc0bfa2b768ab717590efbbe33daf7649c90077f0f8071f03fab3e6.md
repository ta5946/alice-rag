## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/doc/CMakeInstructions.md

**Start chunk id:** 07a0b61b5cc0bfa2b768ab717590efbbe33daf7649c90077f0f8071f03fab3e6

## Content

> ctest -L obvious # execute only tests labeled as "obvious"
Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Starting 1: O2test-ex4-test1
1/3 Test #1: O2test-ex4-test1 ......................   Passed    0.07 sec

All tests passed, 0 failed out of 1

Label Time Summary:
dummy      =   0.07 sec*proc (1 test)
fast       =   0.07 sec*proc (1 test)
obvious    =   0.07 sec*proc (1 test)

Tests can also be chosen by name using a regular expression (`-R`). Exclusion of tests can be done based on labels (`-LE`) or names (`-RE`).

Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Starting 2: O2test-ex4-test2
1/2 Test #2: O2test-ex4-test2 ......................   Passed    0.07 sec
    Starting 3: ensure-executable-naming-convention
2/2 Test #3: ensure-executable-naming-convention ...   Passed    0.03 sec

All tests passed, 0 failed out of 2

---

100% tests passed, with 0 failures out of 8 tests.

Label Time Summary:
mch     =   0.38 sec*proc (8 tests)
muon    =   0.38 sec*proc (8 tests)

Total test time (real) =   0.49 sec

```

Parallel execution (on a machine with 16 cores) :

```

---

100% tests passed, with 0 out of 2 failing.

Label Time Summary:
- dummy: 0.07 sec*proc (1 test)
- fast: 0.07 sec*proc (1 test)

It's also important to note that some tests (very few) are executed only for certain configurations (build types). These tests are not run automatically when using the basic `ctest` command. To run these tests, you must specify the build type, for instance:

```
ctest -C RelWithDebInfo
```

## CTest

In the O2 build directory, running `ctest` executes all the O2 tests, which isn't always necessary or desirable, especially during development.

Fortunately, as demonstrated in [Ex4](#ex4-adding-a-couple-of-tests), there are multiple methods to limit the set of tests run by `ctest`.

Remember that in all commands below, the `-N` option is used to display the list of tests that would be selected without actually running them. To execute the tests, simply omit the `-N` option.

---

Note that CMakeLists.txt should also be treated as code, and therefore, the same attention to detail you use in writing code (such as avoiding code duplication, adding comments, etc.) should be applied to it. Similar to the rest of our code, we can format it using the [cmake-format](https://github.com/cheshirekow/cmake_format) tool (while this tool isn't as advanced as `clang-format`, it can still handle most of the formatting tasks efficiently).

### Examples

The example outputs below are from a Mac, so the shared library extension is `dylib`. On Linux, it would be `so`.

#### [Ex1](../Examples/Ex1) Adding a Basic Library

Given the following source directory structure :

    Ex1
    ├── CMakeLists.txt
    ├── include
    │   └── Ex1
    │       └── A.h
    └── src
        ├── A.cxx
        ├── B.cxx
        └── B.h

With the `CMakeLists.txt` file containing :

    o2_add_library(Ex1 SOURCES src/A.cxx src/B.cxx PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)

this will create a library with two source files, which depend on the FairMQ::FairMQ target.

---

<!-- vim-markdown-toc -->

<!-- doxy
\endcond
/doxy -->

# CMake and CTest Guidelines for AliceO2

## CMake

Please note that this document covers the [new CMake system](CMakeMigration.md); the previous system based on buckets is no longer in use.

### Instructions for Contributors (Developer Documentation)

A sub-module `CMakeLists.txt` specifies one or more _targets_.
A target usually represents a build product, such as a (static or shared) library or an executable. Targets are the fundamental building blocks of any modern CMake build system.

### Example CMakeLists.txt

A typical module's `CMakeLists.txt` includes

- a call to [o2_add_library](../cmake/O2AddLibrary.cmake) to define a library (and its dependencies)
- one or more calls to [o2_add_executable](../cmake/O2AddExecutable.cmake) to define executables (and their dependencies)
- one or more calls to [o2_add_test](../cmake/O2AddTest.cmake) to define tests (and their dependencies)

---

> otool -L stage/lib/libO2Ex2.dylib
stage/lib/libO2Ex2.dylib:
            @rpath/libO2Ex2.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
            @rpath/libRIO.6.16.so (compatibility version 6.16.0, current version 6.16.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
            /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)

---

DOCUMENT:
    ../install-Debug/
    ├── bin
    │   ├── o2-example-ex3
    │   └── o2-example-ex4
    ├── include
    │   ├── Ex1
    │   │   └── A.h
    │   ├── Ex2
    │   │   └── A.h
    │   ├── Ex3
    │   │   └── A.h
    │   └── Ex4
    │       └── A.h
    ├── lib
    │   ├── G__O2Ex2Dict_rdict.pcm
    │   ├── G__O2Ex3Dict_rdict.pcm
    │   ├── G__O2Ex4Dict_rdict.pcm
    │   ├── libO2Ex1.dylib
    │   ├── libO2Ex2.dylib
    │   ├── libO2Ex2.rootmap
    │   ├── libO2Ex3.dylib
    │   ├── libO2Ex3.rootmap
    │   ├── libO2Ex4.dylib
    │   └── libO2Ex4.rootmap
    ├── share
    │   └── config
    │       └── rootmanager.dat
    └── tests
        └── o2-test-ex4-test1

The typical structure of our tests relies on the [Boost.Test](https://www.boost.org/doc/libs/1_70_0/libs/test/doc/html/index.html) framework, which is automatically included by the `o2_add_test` function unless the `NO_BOOST` option is explicitly specified.

---

6/8 Test #270: Detectors/MUON/MCH/Contour/test/Polygon.cxx ..........   Passed    0.05 sec
    Begin 271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx
7/8 Test #271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx ......   Passed    0.05 sec
    Start 272: Detectors/MUON/MCH/Contour/test/Vertex.cxx
8/8 Test #272: Detectors/MUON/MCH/Contour/test/Vertex.cxx ...........   Passed    0.05 sec

---

\page refdocCMakeInstructions Guidelines for Using CMake

\cond DOXYGEN_IGNORE
/doxy -->

<!-- vim-markdown-toc GFM -->

---

```shell
> ctest -L mch -LE long -E Raw
    Begin 265: Detectors/MUON/MCH/Contour/test/BBox.cxx
1/8 Test #265: Detectors/MUON/MCH/Contour/test/BBox.cxx .............   Success    0.04 sec
    Begin 266: Detectors/MUON/MCH/Contour/test/Contour.cxx
2/8 Test #266: Detectors/MUON/MCH/Contour/test/Contour.cxx ..........   Success    0.05 sec
    Begin 267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx
3/8 Test #267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx ...   Success    0.05 sec
    Begin 268: Detectors/MUON/MCH/Contour/test/Edge.cxx
4/8 Test #268: Detectors/MUON/MCH/Contour/test/Edge.cxx .............   Success    0.05 sec
    Begin 269: Detectors/MUON/MCH/Contour/test/Interval.cxx
5/8 Test #269: Detectors/MUON/MCH/Contour/test/Interval.cxx .........   Success    0.05 sec
    Begin 270: Detectors/MUON/MCH/Contour/test/Polygon.cxx
6/8 Test #270: Detectors/MUON/MCH/Contour/test/Polygon.cxx ..........   Success    0.05 sec
```

---

DOCUMENT:
    o2_add_test(test2
                SOURCES test/test2.cxx
                PUBLIC_LINK_LIBRARIES O2::Ex4 O2::Ex3 O2::Ex2
                COMPONENT_NAME Ex4
                LABELS fast dummy)

These test executables will be located in `stage/bin` with names beginning with `o2-test-ex4` (i.e., the COMPONENT_NAME is utilized and converted to lowercase):

    stage/
    ├── bin
    │   ├── o2-example-ex3
    │   ├── o2-example-ex4
    │   ├── o2-test-ex4-test1
    │   └── o2-test-ex4-test2
    └── lib
        ├── libO2Ex1.dylib
        ├── libO2Ex2.dylib
        ├── libO2Ex3.dylib
        └── libO2Ex4.dylib

By default, tests are not installed; however, if the `INSTALL` option is specified for `o2_add_test`, they will be installed. Thus, in the installation directory, only the initial test will be present in the `tests` subdirectory. A complete installation of our four examples would result in:

    stage/
    ├── bin
    │   ├── o2-example-ex3
    │   ├── o2-example-ex4
    │   ├── o2-test-ex4-test1
    │   └── o2-test-ex4-test2
    └── lib
        ├── libO2Ex1.dylib
        ├── libO2Ex2.dylib
        ├── libO2Ex3.dylib
        └── libO2Ex4.dylib

---

### Selecting/excluding by test name (-R/-E)

The simplest method is to use the `-R` (regexp) option to select test names:

```shell
> ctest -N -R test/Contour
  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx
  Test #270: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx

> ctest -N -R "test/Contour\.(.)"
  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx

```

Alternatively, you can use `-E` to exclude tests that match a regular expression, rather than selecting them.

### Selecting/excluding by label (-L/-LE)

If tests are labeled, you can include or exclude them using `-L` or `-LE` respectively. To see all defined labels, use the `--print-labels` option.

---

/Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
            @rpath/libRIO.6.16.so (compatibility version 6.16.0, current version 6.16.0)
            @rpath/libThread.6.16.so (compatibility version 6.16.0, current version 6.16.0)
            @rpath/libCore.6.16.so (compatibility version 6.16.0, current version 6.16.0)
            /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)

---

> otool -L stage/bin/o2-example-ex3
stage/bin/o2-example-ex3:
            @rpath/libO2Ex3.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libO2Ex2.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
            /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)

---

```shell
> ctest -L mch -LE long -E Raw -j 16
    Running 270: Detectors/MUON/MCH/Contour/test/Polygon.cxx
    Running 271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx
    Running 268: Detectors/MUON/MCH/Contour/test/Edge.cxx
    Running 267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx
    Running 269: Detectors/MUON/MCH/Contour/test/Interval.cxx
    Running 266: Detectors/MUON/MCH/Contour/test/Contour.cxx
    Running 265: Detectors/MUON/MCH/Contour/test/BBox.cxx
    Running 272: Detectors/MUON/MCH/Contour/test/Vertex.cxx
1/8 Test #270: Detectors/MUON/MCH/Contour/test/Polygon.cxx ..........   Success    0.08 sec
2/8 Test #271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx ......   Success    0.08 sec
3/8 Test #268: Detectors/MUON/MCH/Contour/test/Edge.cxx .............   Success    0.08 sec
4/8 Test #269: Detectors/MUON/MCH/Contour/test/Interval.cxx .........   Success    0.08 sec
5/8 Test #267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx ...   Success    0.08 sec
```

---

> otool -L stage/lib/libO2Ex1.dylib
stage/lib/libO2Ex1.dylib:
            @rpath/libO2Ex1.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
            /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)
            /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)

---

When you execute `cmake --build .`, you will observe the presence of a `rootmap` file and a `pcm` file alongside the library in the `stage/lib` directory. These files need to be placed together with the library to facilitate easy loading from the Root prompt.

```
ls stage/lib/*Ex2*
stage/lib/G__O2ExDict_rdict.pcm
stage/lib/libO2Ex2.dylib
stage/lib/libO2Ex2.rootmap
```

Examining the dependencies of libO2Ex2 reveals that they include those of libO2Ex1, plus additional ROOT dependencies due to the dictionary inclusion.

---

Finally, take note of the `LABELS` (plural) option, which is useful for categorizing tests and/or choosing which tests to execute.

> ctest
Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Start 1: O2test-ex4-test1
1/3 Test #1: O2test-ex4-test1 ......................   Passed    0.07 sec
    Start 2: O2test-ex4-test2
2/3 Test #2: O2test-ex4-test2 ......................   Passed    0.07 sec
    Start 3: ensure-executable-naming-convention
3/3 Test #3: ensure-executable-naming-convention ...   Passed    0.03 sec

100% tests passed, 0 tests failed out of 3

Label Time Summary:
dummy      =   0.14 sec*proc (2 tests)
fast       =   0.14 sec*proc (2 tests)
obvious    =   0.07 sec*proc (1 test)

---

The command `o2_add_library(Ex2 SOURCES src/A.cxx src/B.cxx PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)` will create a library that depends on the `FairMQ::FairMQ` target and includes three source files (the specified `A.cxx` and `B.cxx` files, plus a dictionary generated by `o2_target_root_dictionary`). Additionally, the `o2_target_root_dictionary` function not only adds a dictionary source file but also includes a dependency on the `ROOT::RIO` target for the dictionary component, which is necessary at link time.

The `HEADERS` parameter for `o2_target_root_dictionary` is required, but the `LINKDEF` parameter can be left out if a LinkDef file named `[targetBaseName]LinkDef.h` is located in the `[targetBaseName]` source directory (as in the example, where `src/Ex2LinkDef.h` could have been omitted).

---

In the `o2_add_executable`, there are three key points to consider.

First, the `Ex3` library, which is built within the same module and referred to by its fully qualified name `O2::Ex3`, is referenced. Simply using `Ex3` would not be effective because it does not correspond to a defined target (`Ex3` is merely the target base name). Similarly, the "external" (to this module) `Ex2` library is referenced using its fully qualified name `O2::Ex2`. Both the target dependencies and include dependencies are gathered, ensuring that the necessary include directories, such as `include/Ex2`, are correctly located during compilation.

Second, the `COMPONENT_NAME` argument is utilized, which will be part of the executable name. Consequently, the output executable will be named `o2-example-ex3`, adhering to our [naming convention for executables](https://rawgit.com/AliceO2Group/CodingGuidelines/master/naming_formatting.html#Executable_Names).

---

Optionally, it may include a call to [o2_target_root_dictionary](../cmake/O2TargetRootDictionary.cmake) if the module's library needs a Root dictionary.

All _direct_ dependencies should be _explicitly_ listed using the `PUBLIC_LINK_LIBRARIES` keyword in the various o2_xxx functions.

Keep in mind that, although the parameter name suggests otherwise, `PUBLIC_LINK_LIBRARIES` should reference _target_ names, not library names. You must use the fully qualified `O2::targetName` instead of the shortened `basename` used to define the target. Additionally, if the referenced target does not exist, CMake will inform you during the configuration stage, which is beneficial.

---

```shell
> ctest -N -L mch
  Test #268: Detectors/MUON/MCH/Contour/test/BBox.cxx
  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx
  Test #270: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx
  Test #271: Detectors/MUON/MCH/Contour/test/Edge.cxx
  Test #272: Detectors/MUON/MCH/Contour/test/Interval.cxx
  Test #273: Detectors/MUON/MCH/Contour/test/Polygon.cxx
  Test #274: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx
  Test #275: Detectors/MUON/MCH/Contour/test/Vertex.cxx
  Test #276: Detectors/MUON/MCH/Simulation/macros/drawMCHGeometry.C
  Test #277: Detectors/MUON/MCH/Simulation/macros/drawMCHGeometry.C_compiled
```

### Enhancing ctest Execution Speed

It's worth noting that `ctest` allows you to run tests in parallel (unless they are specifically marked as unsafe to run in parallel) by using the `-j n` option, where `n` indicates the maximum number of tests to run concurrently.

Serial execution:
```shell

---

The document will outline a library composed of 2 source files, which relies on the FairMQ::FairMQ target.

Upon executing `cmake --build .`, you will locate the library in the `stage/lib` directory. For example, on a Mac:

    > ls stage/lib/*Ex1*
    stage/lib/libO2Ex1.dylib

To inspect the built library dependencies, use `otool -L` on macOS or `ldd` on Linux.

---

In the documentation, you can observe the dependencies on the Ex2 and Ex3 libraries, as well as their dependencies (FairMQ, ROOT) and their respective dependencies (FairLogger).

Additionally, the generated executable can be run directly from the build directory without needing to configure the `PATH` or `LD_LIBRARY_PATH` environment variables.

    > stage/bin/o2-example-ex3
    Hello from ex2::A ctor
    Hello from ex3::A ctor

This is due to the correct setting of the [RPATH](https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/RPATH-handling) by CMake for the build directory. It should also be correctly configured during the installation process.

#### [Ex4](../Examples/Ex4) Incorporating a Few Tests

We will include two simple tests in our existing example.

    o2_add_test(test1
                SOURCES test/test1.cxx
                PUBLIC_LINK_LIBRARIES O2::Ex4
                COMPONENT_NAME Ex4
                LABELS fast dummy obvious
                INSTALL)

---

\cond DOXYGEN_IGNORE
/doxy -->

<!-- vim-markdown-toc GFM -->

* [CMake and CTest guidance for AliceO2](#cmake-and-ctest-guidance-for-aliceo2)
  * [CMake](#cmake)
    * [Guidelines for contributors (developer documentation)](#guidelines-for-contributors-developer-documentation)
    * [Sample CMakeLists.txt](#sample-cmakeliststxt)
    * [Examples](#examples)
      * [Ex1 Adding a basic library](#ex1-adding-a-basic-library)
      * [Ex2 Adding a basic library with a Root dictionary](#ex2-adding-a-basic-library-with-a-root-dictionary)
      * [Ex3 Adding an executable](#ex3-adding-an-executable)
      * [Ex4 Adding a couple of tests](#ex4-adding-a-couple-of-tests)
      * [Ex5 Adding a man page](#ex5-adding-a-man-page)
  * [CTest](#ctest)
    * [Filtering tests by name (-R/-E)](#filtering-tests-by-name--r-e)
    * [Filtering tests by label (-L/-LE)](#filtering-tests-by-label--l-le)
    * [Improving ctest execution speed](#improving-ctest-execution-speed)

---

The direct dependency on `FairMQ` can be found easily. The other dependencies, such as `boost` and `FairLogger`, are transitive, meaning they are included by `FairMQ` and CMake adds them automatically.

After running the command `cmake --build . -- install` (note the singular `--` is intentional), the library will be located in the `lib` directory under the installation path, while its public header files (only `A.h` in this case) will be in the `include/Ex1` directory:

```
> ls [install_topdir]
├── include
│   ├── Ex1
│   │   └── A.h
├── lib
│   └── libO2Ex1.dylib
```

#### [Ex2](../Examples/Ex2) Incorporating a basic library with a Root dictionary

Building upon the previous example (where `A.h` now employs `ClassDef`), we will now integrate a Root dictionary:

```
Ex2
├── CMakeLists.txt
├── include
│   └── Ex2
│       └── A.h
└── src
    ├── A.cxx
    ├── B.cxx
    ├── B.h
    └── Ex2LinkDef.h
```

---

Runtime dependencies for the executable can be identified using either the `otool -L` command on macOS or the `ldd` command on Linux:

---

/Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)
    /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
    @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
    @rpath/libThread.6.16.so (compatibility version 6.16.0, current version 6.16.0)
    @rpath/libCore.6.16.so (compatibility version 6.16.0, current version 6.16.0)
    /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)

---

5/8 Test #267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx ...   Successfully Passed    0.08 sec
6/8 Test #266: Detectors/MUON/MCH/Contour/test/Contour.cxx ..........   Successfully Passed    0.08 sec
7/8 Test #265: Detectors/MUON/MCH/Contour/test/BBox.cxx .............   Successfully Passed    0.08 sec
8/8 Test #272: Detectors/MUON/MCH/Contour/test/Vertex.cxx ...........   Successfully Passed    0.08 sec

---

The include installation will resemble that of Ex1: the `LinkDef.h` file is _not_ included (unless you place it in include/Ex2, but that is not advisable).

    > ls [install_topdir]
    ├── include
    │   ├── Ex2
    │       └── A.h
    ├── lib
    │   ├── G__O2ExDict_rdict.pcm
    │   ├── libO2Ex2.dylib
    │   ├── libO2Ex2.rootmap

#### [Ex3](../Examples/Ex3) Incorporating an Executable

Building on the previous example, Ex3 now includes an executable:

    Ex3
    ├── CMakeLists.txt
    ├── include
    │   └── Ex3
    │       └── A.h
    └── src
        ├── A.cxx
        ├── B.cxx
        ├── B.h
        ├── Ex2LinkDef.h
        └── run.cxx

    o2_add_library(Ex3
            SOURCES src/A.cxx src/B.cxx
            PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)

    o2_target_root_dictionary(Ex3
            HEADERS include/Ex3/A.h src/B.h)

    o2_add_executable(ex3
            SOURCES src/run.cxx
            PUBLIC_LINK_LIBRARIES O2::Ex3 O2::Ex2
            COMPONENT_NAME example)

---

100% of the tests passed, with no failed tests out of a total of 8.

Label Time Summary:
mch     =   0.65 sec*proc (8 tests)
muon    =   0.65 sec*proc (8 tests)

Total test time (real) =   0.19 sec

---

/Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
            @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
            /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)