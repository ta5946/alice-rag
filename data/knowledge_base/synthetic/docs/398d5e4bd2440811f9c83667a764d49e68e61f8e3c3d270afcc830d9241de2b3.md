## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/DATA/production/configurations/2022/MayJunePilotBeam/apass1/parse.sh

**Start chunk id:** 398d5e4bd2440811f9c83667a764d49e68e61f8e3c3d270afcc830d9241de2b3

## Content

DOCUMENT:
    startmonth=`echo $start | cut -d'-' -f2`
  startday=`echo $start | cut -d'-' -f3`
  starthour=`echo $start | cut -d'-' -f4`
  startminute=`echo $start | cut -d'-' -f5`
  startsecond=`echo $start | cut -d'-' -f6`

  goodITSmonth=`echo $goodITS | cut -d'-' -f2`
  goodITSday=`echo $goodITS | cut -d'-' -f3`
  goodITShour=`echo $goodITS | cut -d'-' -f4`
  goodITSminute=`echo $goodITS | cut -d'-' -f5`
  goodITSsecond=`echo $goodITS | cut -d'-' -f6`

  goodMFTmonth=`echo $goodMFT | cut -d'-' -f2`
  goodMFTday=`echo $goodMFT | cut -d'-' -f3`
  goodMFThour=`echo $goodMFT | cut -d'-' -f4`
  goodMFTminute=`echo $goodMFT | cut -d'-' -f5`
  goodMFTsecond=`echo $goodMFT | cut -d'-' -f6`

    PARAPHRASED DOCUMENT:

---

display "good ITS: month = $goodITSmonth, day = $goodITSday, hour = $goodITShour, minute = $goodITSminute, seconds = $goodITSsecond"
    display "good MFT: month = $goodMFTmonth, day = $goodMFTday, hour = $goodMFThour, minute = $goodMFTminute, seconds = $goodMFTsecond"
    display "checking: month = $startmonth, day = $startday, hour = $starthour, minute = $startminute, seconds = $startsecond"

---

# check for ITS
if [[ $startmonth < $goodITSmonth ]]; then
  echo "month initiates remappingITS"
  remappingITS=1
elif [[ $startmonth == $goodITSmonth ]]; then
  if [[ $startday < $goodITSday ]]; then
    echo "day initiates remappingITS"
    remappingITS=1
  elif [[ $startday == $goodITSday ]]; then
    if [[ $starthour < $goodITShour ]]; then
      echo "hour initiates remappingITS"
      remappingITS=1
    elif [[ $starthour == $goodITShour ]]; then
      if [[ $startminute < $goodITSminute ]]; then
        echo "minute initiates remappingITS"
        remappingITS=1
      elif [[ $startminute == $goodITSminute ]]; then
        if [[ $startsecond -le $goodITSsecond ]]; then
          echo "second initiates remappingITS"
          remappingITS=1
        else
          echo "month, day, hour, and minute would initiate remapping for ITS, but seconds exceed the threshold for triggering remapping"
        fi
      else
    fi
  fi
fi

---

echo "start = $start, ITS is good = $goodITS, MFT is good = $goodMFT, ITS remapping = $remappingITS, MFT remapping = $remappingMFT"
fi

---

#!/bin/bash

line=$(grep $1 $O2DPG_ROOT/DATA/production/configurations/$ALIEN_JDL_LPMANCHORYEAR/$O2DPGPATH/$ALIEN_JDL_LPMPASSNAME/ctf2epn.txt)
echo "line found in file = $line"
if [[ -z $line ]]; then
  echo "CTF file not found in the list, no remapping needed"
  export remappingITS=0
  export remappingMFT=0
  echo "remappingITS = $remappingITS, remappingMFT = $remappingMFT"
else
  epn=$(echo $line | cut -d' ' -f1)
  start=$(echo $line | cut -d' ' -f2)
  echo "epn = $epn"
  echo "start of CTF data = $start"

  lineTimes=$(grep ${epn} $O2DPG_ROOT/DATA/production/configurations/$ALIEN_JDL_LPMANCHORYEAR/$O2DPGPATH/$ALIEN_JDL_LPMPASSNAME/goodITSMFT_fixed.txt)
  echo "lineTimes = $lineTimes"
  goodITS=$(echo $lineTimes | cut -d' ' -f2)
  echo "goodITS = $goodITS"
  goodMFT=$(echo $lineTimes | sed 's/^[0-9][0-9][0-9] \(2022-[0-9]*-[0-9]*-[0-9]*-[0-9]*-[0-9]*\) \(2022-[0-9]*-[0-9]*-[0-9]*-[0-9]*-[0-9]*\)/\2/')
  echo "goodMFT = $goodMFT"

---

DOCUMENT:
  if [[ $startmonth < $goodMFTmonth ]]; then
    echo "month triggers remappingMFT"
    remappingMFT=1
  elif [[ $startmonth == $goodMFTmonth ]]; then
    if [[ $startday < $goodMFTday ]]; then
      echo "day triggers remappingMFT"
      remappingMFT=1
    elif [[ $startday == $goodMFTday ]]; then
      if [[ $starthour < $goodMFThour ]]; then
	echo "hour triggers remappingMFT"
	remappingMFT=1
      elif [[ $starthour == $goodMFThour ]]; then
	if [[ $startminute < $goodMFTminute ]]; then
	  echo "minute triggers remappingMFT"
	  remappingMFT=1
	elif [[ $startminute == $goodMFTminute ]]; then
	  if [[ $startsecond -le $goodMFTsecond ]]; then
	    echo "second triggers remappingMFT"
	    remappingMFT=1
	  else
	    echo "month, day, hour, and minute would trigger remapping, but seconds are larger than the threshold needed for remapping MFT"
	  fi
	else

---

else
  echo "month, day, hour would trigger remapping, but the minutes exceed the necessary threshold for ITS remapping"
fi
else
  echo "month, day would trigger remapping, but the hours exceed the necessary threshold for ITS remapping"
fi
else
  echo "month would trigger remapping, but the days exceed the necessary threshold for ITS remapping"
fi
else
  echo "the start month is later than the threshold needed to trigger remapping for ITS"
fi

---

DOCUMENT:
    fi
	else
	  echo "month, day, hour would trigger remapping, but minutes exceed the threshold for MFT remapping"
	fi
      else
	echo "month, day would trigger remapping, but hours exceed the threshold for MFT remapping"
      fi
    else
      echo "month, would trigger remapping, but days exceed the threshold for MFT remapping"
    fi
  else 
    echo "start month is later than the threshold needed for MFT remapping"
  fi