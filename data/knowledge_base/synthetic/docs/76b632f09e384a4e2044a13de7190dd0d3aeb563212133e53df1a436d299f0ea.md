## Metadata

**Document link:** https://github.com/AliceO2Group/AliceO2/blob/dev/run/SimExamples/HepMC_JETSCAPE/jetscape.sh

**Start chunk id:** 76b632f09e384a4e2044a13de7190dd0d3aeb563212133e53df1a436d299f0ea

## Content

# Main XML file extracted from the JETSCAPE directory
runJetscape $xml.xml $JETSCAPE_ROOT/config/jetscape_master.xml

---

#!/bin/sh
# Script inspired by EPOS4 example
# This script runs JETSCAPE using a specified XML file, setting the RNG seed and custom HepMC output filename. Unlike the EPOS example, the HepMC output is saved in a specifically named file rather than via stdout.

xml="example"
seed=$RANDOM
hepmc="jetout.hepmc"

usage()
{
    cat <<EOF
Usage: $0 [OPTIONS]

Options:

  -i,--input   INPUT       XML user file fed to JETSCAPE ($xml)
  -o,--output  OUTPUT      HepMC output file ($hepmc)
  -s,--seed    SEED        RNG seed ($seed)
  -h,--help                Display these instructions
  --                       Additional command line arguments passed to o2-sim

EOF
}

while test $# -gt 0 ; do
    case $1 in
        -i|--input)   xml=$2 ; shift ;;
        -o|--output)  hepmc=$2 ; shift ;;
        -s|--seed)    seed=$2 ; shift ;;
        -h|--help) usage; exit 0 ;;
    esac
    shift
done

if [ ! -f $xml.xml ]; then
    echo "Error: Options file $xml.xml not found"
    exit 1
fi

---

if [ ! -f $xml.xml ]; then
    echo "Error: Options file $xml.xml not found"
    exit 1
fi

if [ $seed -eq 0 ]; then
    echo "Seed can't be 0, a random number will be used instead"
    seed=$RANDOM
else
    if grep -Fq "<seed>" $xml.xml; then
        sed -i "/<seed>/c\  <seed>$seed</seed>" $xml.xml
    else
        sed -i "/<\/jetscape>/i\  <Random>\n    <seed>$seed</seed>\n  </Random>" $xml.xml
    fi
    echo "Seed set to $seed"
fi

# Verify if the HepMC output has been configured
if [ ! -z "$hepmc" ]; then
    # Remove file extension
    newhep=$(echo $hepmc | sed 's/.hepmc//')
    if grep -Fq "<outputFilename>" $xml.xml; then
        sed -i "/<outputFilename>/c\  <outputFilename>$newhep</outputFilename>" $xml.xml
    else
        sed -i "/<jetscape>/a\  <outputFilename>$newhep</outputFilename>" $xml.xml
    fi
    echo "HepMC output file set to $hepmc"
else
    echo "Error: HepMC output file not set"
    exit 2
fi