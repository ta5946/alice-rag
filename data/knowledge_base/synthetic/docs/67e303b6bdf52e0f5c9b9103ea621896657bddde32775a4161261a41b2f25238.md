## Metadata

**Document link:** https://github.com/AliceO2Group/simulation/blob/main/docs/mcsteplogger/README.md

**Start chunk id:** 67e303b6bdf52e0f5c9b9103ea621896657bddde32775a4161261a41b2f25238

## Content

---
sort: 5
title: MCStepLogger
---

# MCStepLogger

This section provides an overview of the fundamental features of MCStepLogger. For a comprehensive explanation, consult the package's [readme](https://github.com/AliceO2Group/VMCStepLogger/tree/master/MCStepLogger).
MCStepLogger is designed to log and analyze the individual steps generated by detector simulation engines based on the [Virtual Monte Carlo (VMC)](https://vmc-project.github.io/).

To integrate it with O2 simulations, ensure you use `o2-sim-serial` **instead of** `o2-sim`.

## Basic usage

```bash
LD_PRELOAD=path_to/libMCStepLoggerInterceptSteps.so o2-sim-serial -m PIPE ITS TPC -n 10
```

---

### Special case on macOS

`LD_PRELOAD` needs to be substituted with `DYLD_INSERT_LIBRARIES`, for example:

```bash
DYLD_INSERT_LIBRARIES=/Users/laurent/alice/sw/osx_x86-64/O2/latest-clion-o2/lib/libMCStepLogger.dylib MCSTEPLOG_TTREE=1 MCSTEPLOG_OUTFILE=toto.root o2-sim-serial -m MCH -g fwmugen -n 1
```

`LD_DEBUG=libs` should be replaced with `DYLD_PRINT_LIBRARIES=1`

`LD_DEBUG=statistics` should be replaced with `DYLD_PRINT_STATISTICS=1`

{% include list.liquid all=true %}

---

```bash
[MCLOGGER:] START FLUSHING ----
[STEPLOGGER]: executed 28 steps
[STEPLOGGER]: moved 1 unique tracks
[STEPLOGGER]: handled 1 unique types
[STEPLOGGER]: VolName cave COUNT 23 SECONDARIES 0
[STEPLOGGER]: VolName normalPCB1 COUNT 3 SECONDARIES 0
[STEPLOGGER]: ----- END OF EVENT ------
[FIELDLOGGER]: performed 21 steps
[FIELDLOGGER]: VolName cave COUNT 20
[FIELDLOGGER]: ----- END OF EVENT ------
[MCLOGGER:] END FLUSHING ----
```

The stepping logger data can also be written to an output tree for more detailed analysis. By default, the output file is named `MCStepLoggerOutput.root` (which can be modified by adjusting the `MCSTEPLOG_OUTFILE` environment variable). To activate this feature, use:

```bash
MCSTEPLOG_TTREE=1 LD_PRELOAD=path_to/libMCStepLogger.so o2-sim-serial ...
```

### Special case on macOS

On macOS, replace `LD_PRELOAD` with `DYLD_INSERT_LIBRARIES`, for example:
```bash
MCSTEPLOG_TTREE=1 DYLD_INSERT_LIBRARIES=path_to/libMCStepLogger.so o2-sim-serial ...
```