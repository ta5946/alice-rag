## Metadata

**Document link:** https://github.com/AliceO2Group/O2DPG/blob/master/MC/run/PWGUD/runPythiaAndDiffEvents.sh

**Start chunk id:** cbcbd3116afed5073f7c16f7e20ee061887e90b8d2aafa3ab69eb06a31d477c1

## Content

#!/usr/bin/env bash

# ensure O2DPG and O2 are set up
[ ! "${O2DPG_ROOT}" ] && echo "Error: O2DPG needs to be loaded" && exit 1
[ ! "${O2_ROOT}" ] && echo "Error: O2 needs to be loaded" && exit 1

# include utility functions
. ${O2_ROOT}/share/scripts/jobutils.sh

ECM=${ECM:-13600}
RNDSEED=${RNDSEED:-0}
NSIGPTF=${NSIGPTF:-100}
NBKGPTF=${NBKGPTF:-1000}
NWORKERS=${NWORKERS:-4}
NTIMEFRAMES=${NTIMEFRAMES:-1}
BKGINTRATE=${BKGINTRATE:-50000}

# specify the hepmc3 file containing signal events
FHEPMC=${FHEPMC:-"diffEvents.hepmc3"}
FHEPMC=${PWD}/${FHEPMC}
if [ ! -f ${FHEPMC} ]; then
  echo "Error: Data file ${FHEPMC} is missing" && exit 1
fi

# define vertex settings
DVX=0.01
DVY=0.01
DVZ=6.00

MODULES="--skipModules ZDC"

---

# vertex settings
DVX=0.01
DVY=0.01
DVZ=6.00

MODULES="--skipModules ZDC"

# create workflow
SIGINTRATE=`echo "${BKGINTRATE}*${NSIGPTF}/${NBKGPTF}" | bc`
NBKG=`echo "${NBKGPTF}*${NTIMEFRAMES}" | bc`
NSIG=`echo "${NSIGPTF}*${NTIMEFRAMES}" | bc`
${O2DPG_ROOT}/MC/bin/o2dpg_sim_workflow.py \
  -col pp \
  -eCM ${ECM} \
  -j ${NWORKERS} \
  -e TGeant4 \
  -mod "${MODULES}" \
  -tf ${NTIMEFRAMES} \
  -interactionRate ${BKGINTRATE} \
  -gen hepmc \
  -genBkg pythia8 \
  -procBkg cdiff \
  -colBkg pp \
  -nb ${NBKG} \
  -ns ${NBKGPTF} \
  -confKey "HepMC.fileName="${FHEPMC}";HepMC.version=3;Diamond.width[0]=0.01;Diamond.width[1]=0.01;Diamond.width[2]=6." \
  -confKeyBkg "Diamond.width[0]="${DVX}";Diamond.width[1]="${DVY}";Diamond.width[2]="${DVZ}""  \
  --embedding --embeddPattern ${SIGINTRATE}","${NSIGPTF}":"${NSIG}"

# run workflow
${O2DPG_ROOT}/MC/bin/o2_dpg_workflow_runner.py -f workflow.json -tt aod